<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nabil Mikhael, Alessandro Gregori">
<meta name="dcterms.date" content="2025-09-19">

<title>PRR MINICHALLENGE FS24</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="PRR_MC_QuartoDocument_files/libs/clipboard/clipboard.min.js"></script>
<script src="PRR_MC_QuartoDocument_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="PRR_MC_QuartoDocument_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="PRR_MC_QuartoDocument_files/libs/quarto-html/popper.min.js"></script>
<script src="PRR_MC_QuartoDocument_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="PRR_MC_QuartoDocument_files/libs/quarto-html/anchor.min.js"></script>
<link href="PRR_MC_QuartoDocument_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="PRR_MC_QuartoDocument_files/libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="PRR_MC_QuartoDocument_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="PRR_MC_QuartoDocument_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="PRR_MC_QuartoDocument_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="PRR_MC_QuartoDocument_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="PRR_MC_QuartoDocument_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="PRR_MC_QuartoDocument_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="PRR_MC_QuartoDocument_files/libs/datatables-binding-0.34.0/datatables.js"></script>
<script src="PRR_MC_QuartoDocument_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="PRR_MC_QuartoDocument_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="PRR_MC_QuartoDocument_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="PRR_MC_QuartoDocument_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="PRR_MC_QuartoDocument_files/libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="PRR_MC_QuartoDocument_files/libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">1. SETUP</a>
  <ul class="collapse">
  <li><a href="#renv" id="toc-renv" class="nav-link" data-scroll-target="#renv">1.1 Renv</a></li>
  <li><a href="#installieren-der-packages" id="toc-installieren-der-packages" class="nav-link" data-scroll-target="#installieren-der-packages">1.2 Installieren der packages</a></li>
  <li><a href="#laden-der-packages" id="toc-laden-der-packages" class="nav-link" data-scroll-target="#laden-der-packages">1.3 Laden der packages</a></li>
  </ul></li>
  <li><a href="#webscraping" id="toc-webscraping" class="nav-link" data-scroll-target="#webscraping">2. WEBSCRAPING</a>
  <ul class="collapse">
  <li><a href="#funktion-extraktion-letzte-seite" id="toc-funktion-extraktion-letzte-seite" class="nav-link" data-scroll-target="#funktion-extraktion-letzte-seite">2.1 Funktion Extraktion letzte Seite</a></li>
  <li><a href="#erstellen-des-leeren-dataframes" id="toc-erstellen-des-leeren-dataframes" class="nav-link" data-scroll-target="#erstellen-des-leeren-dataframes">2.2 Erstellen des leeren Dataframes</a></li>
  <li><a href="#vektorerstellung-der-gesuchten-städte" id="toc-vektorerstellung-der-gesuchten-städte" class="nav-link" data-scroll-target="#vektorerstellung-der-gesuchten-städte">2.3 Vektorerstellung der gesuchten Städte</a></li>
  <li><a href="#scraping" id="toc-scraping" class="nav-link" data-scroll-target="#scraping">2.4 Scraping</a></li>
  </ul></li>
  <li><a href="#datenaufbereitung" id="toc-datenaufbereitung" class="nav-link" data-scroll-target="#datenaufbereitung">3. DATENAUFBEREITUNG</a>
  <ul class="collapse">
  <li><a href="#übersicht" id="toc-übersicht" class="nav-link" data-scroll-target="#übersicht">3.1 Übersicht</a></li>
  <li><a href="#beobachtungen-mit-nas-entfernen" id="toc-beobachtungen-mit-nas-entfernen" class="nav-link" data-scroll-target="#beobachtungen-mit-nas-entfernen">3.2 Beobachtungen mit NA’s entfernen</a></li>
  </ul></li>
  <li><a href="#datenexploration" id="toc-datenexploration" class="nav-link" data-scroll-target="#datenexploration">4. DATENEXPLORATION</a>
  <ul class="collapse">
  <li><a href="#vergleich-statistischer-kennzahlen" id="toc-vergleich-statistischer-kennzahlen" class="nav-link" data-scroll-target="#vergleich-statistischer-kennzahlen">4.1 Vergleich statistischer Kennzahlen</a>
  <ul class="collapse">
  <li><a href="#erstellen-der-summaries" id="toc-erstellen-der-summaries" class="nav-link" data-scroll-target="#erstellen-der-summaries">4.1.1 Erstellen der Summaries</a></li>
  <li><a href="#erstellen-des-dataframes" id="toc-erstellen-des-dataframes" class="nav-link" data-scroll-target="#erstellen-des-dataframes">4.1.2 Erstellen des Dataframes</a></li>
  <li><a href="#lollipop-plot-summary-preise-und-wohnungsgrössen" id="toc-lollipop-plot-summary-preise-und-wohnungsgrössen" class="nav-link" data-scroll-target="#lollipop-plot-summary-preise-und-wohnungsgrössen">4.1.3 Lollipop-Plot Summary Preise und Wohnungsgrössen</a></li>
  </ul></li>
  <li><a href="#barplot-anzahl-angebote" id="toc-barplot-anzahl-angebote" class="nav-link" data-scroll-target="#barplot-anzahl-angebote">4.2 Barplot Anzahl Angebote</a></li>
  <li><a href="#scatterplot-wohnungsgrösse-vs.-preis" id="toc-scatterplot-wohnungsgrösse-vs.-preis" class="nav-link" data-scroll-target="#scatterplot-wohnungsgrösse-vs.-preis">4.3 Scatterplot Wohnungsgrösse vs.&nbsp;Preis</a></li>
  <li><a href="#densityplot-preisvergleich" id="toc-densityplot-preisvergleich" class="nav-link" data-scroll-target="#densityplot-preisvergleich">4.4 Densityplot Preisvergleich</a></li>
  <li><a href="#densityplot-wohnungsgrössenvergleich" id="toc-densityplot-wohnungsgrössenvergleich" class="nav-link" data-scroll-target="#densityplot-wohnungsgrössenvergleich">4.5 Densityplot Wohnungsgrössenvergleich</a></li>
  <li><a href="#boxplot-preisvergleich" id="toc-boxplot-preisvergleich" class="nav-link" data-scroll-target="#boxplot-preisvergleich">4.6 Boxplot Preisvergleich</a></li>
  <li><a href="#boxplot-wohnungsgrössenvergleich" id="toc-boxplot-wohnungsgrössenvergleich" class="nav-link" data-scroll-target="#boxplot-wohnungsgrössenvergleich">4.7 Boxplot Wohnungsgrössenvergleich</a></li>
  <li><a href="#barplot-anzahl-plz" id="toc-barplot-anzahl-plz" class="nav-link" data-scroll-target="#barplot-anzahl-plz">4.8 Barplot Anzahl PLZ</a></li>
  </ul></li>
  <li><a href="#resultate" id="toc-resultate" class="nav-link" data-scroll-target="#resultate">5. RESULTATE</a></li>
  <li><a href="#ausblick" id="toc-ausblick" class="nav-link" data-scroll-target="#ausblick">6. AUSBLICK</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PRR MINICHALLENGE FS24</h1>
<p class="subtitle lead">Scraping und Vergleich von Immobilien-Mietangeboten</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nabil Mikhael, Alessandro Gregori </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 19, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="setup" class="level1">
<h1>1. SETUP</h1>
<section id="renv" class="level2">
<h2 class="anchored" data-anchor-id="renv">1.1 Renv</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verwende renv mit Projekt:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">init</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- One or more packages recorded in the lockfile are not installed.
- Use `renv::status()` for more details.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Speichere aktuell verwendete Pakete in ein .lockfile</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">snapshot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The following package(s) will be updated in the lockfile:

# CRAN -----------------------------------------------------------------------
- broom           [1.0.5 -&gt; 1.0.10]
- colorspace      [2.1-0 -&gt; *]
- crosstalk       [1.2.1 -&gt; 1.2.2]
- curl            [5.2.0 -&gt; 7.0.0]
- data.table      [1.15.0 -&gt; 1.17.8]
- dbplyr          [2.4.0 -&gt; 2.5.1]
- DT              [0.33 -&gt; 0.34.0]
- dtplyr          [1.3.1 -&gt; 1.3.2]
- ellipsis        [0.3.2 -&gt; *]
- evaluate        [0.23 -&gt; 1.0.5]
- fansi           [1.0.6 -&gt; *]
- gargle          [1.5.2 -&gt; 1.6.0]
- generics        [0.1.3 -&gt; 0.1.4]
- ggplot2         [3.5.0 -&gt; 4.0.0]
- googledrive     [2.1.1 -&gt; 2.1.2]
- googlesheets4   [1.1.1 -&gt; 1.1.2]
- haven           [2.5.4 -&gt; 2.5.5]
- highr           [0.10 -&gt; 0.11]
- httpuv          [1.6.14 -&gt; *]
- knitr           [1.45 -&gt; 1.50]
- later           [1.3.2 -&gt; 1.4.4]
- lattice         [0.21-9 -&gt; *]
- lubridate       [1.9.3 -&gt; 1.9.4]
- magrittr        [2.0.3 -&gt; 2.0.4]
- MASS            [7.3-60 -&gt; *]
- Matrix          [1.6-1.1 -&gt; *]
- mgcv            [1.9-0 -&gt; *]
- munsell         [0.5.0 -&gt; *]
- nlme            [3.1-163 -&gt; *]
- openssl         [2.1.1 -&gt; 2.3.3]
- pillar          [1.9.0 -&gt; 1.11.1]
- promises        [1.2.1 -&gt; 1.3.3]
- purrr           [1.0.2 -&gt; 1.1.0]
- ragg            [1.2.7 -&gt; 1.5.0]
- Rcpp            [1.0.12 -&gt; 1.1.0]
- readxl          [1.4.3 -&gt; 1.4.5]
- reprex          [2.1.0 -&gt; 2.1.1]
- rmarkdown       [2.25 -&gt; 2.29]
- rstudioapi      [0.15.0 -&gt; 0.17.1]
- rvest           [1.0.4 -&gt; 1.0.5]
- scales          [1.3.0 -&gt; 1.4.0]
- stringr         [1.5.1 -&gt; 1.5.2]
- systemfonts     [1.0.5 -&gt; 1.2.3]
- textshaping     [0.3.7 -&gt; 1.0.3]
- tibble          [3.2.1 -&gt; 3.3.0]
- tinytex         [0.49 -&gt; 0.57]
- tzdb            [0.4.0 -&gt; 0.5.0]
- utf8            [1.2.4 -&gt; 1.2.6]
- uuid            [1.2-0 -&gt; 1.2-1]
- xfun            [0.43 -&gt; 0.53]
- xml2            [1.3.6 -&gt; 1.4.0]
- yaml            [2.3.8 -&gt; 2.3.10]
- S7              [* -&gt; 0.2.0]

# RSPM -----------------------------------------------------------------------
- askpass         [repo: CRAN -&gt; RSPM; ver: 1.2.0 -&gt; 1.2.1]
- backports       [repo: CRAN -&gt; RSPM; ver: 1.4.1 -&gt; 1.5.0]
- bit             [repo: CRAN -&gt; RSPM; ver: 4.0.5 -&gt; 4.6.0]
- bit64           [repo: CRAN -&gt; RSPM; ver: 4.0.5 -&gt; 4.6.0-1]
- bslib           [repo: CRAN -&gt; RSPM; ver: 0.6.1 -&gt; 0.9.0]
- cachem          [repo: CRAN -&gt; RSPM; ver: 1.0.8 -&gt; 1.1.0]
- callr           [repo: CRAN -&gt; RSPM; ver: 3.7.5 -&gt; 3.7.6]
- cli             [repo: CRAN -&gt; RSPM; ver: 3.6.2 -&gt; 3.6.5]
- cpp11           [repo: CRAN -&gt; RSPM; ver: 0.4.7 -&gt; 0.5.2]
- crayon          [repo: CRAN -&gt; RSPM; ver: 1.5.2 -&gt; 1.5.3]
- DBI             [repo: CRAN -&gt; RSPM; ver: 1.2.2 -&gt; 1.2.3]
- digest          [repo: CRAN -&gt; RSPM; ver: 0.6.34 -&gt; 0.6.37]
- farver          [repo: CRAN -&gt; RSPM; ver: 2.1.1 -&gt; 2.1.2]
- fastmap         [repo: CRAN -&gt; RSPM; ver: 1.1.1 -&gt; 1.2.0]
- fontawesome     [repo: CRAN -&gt; RSPM; ver: 0.5.2 -&gt; 0.5.3]
- fs              [repo: CRAN -&gt; RSPM; ver: 1.6.3 -&gt; 1.6.6]
- glue            [repo: CRAN -&gt; RSPM; ver: 1.7.0 -&gt; 1.8.0]
- gtable          [repo: CRAN -&gt; RSPM; ver: 0.3.4 -&gt; 0.3.6]
- htmltools       [repo: CRAN -&gt; RSPM; ver: 0.5.7 -&gt; 0.5.8.1]
- jsonlite        [repo: CRAN -&gt; RSPM; ver: 1.8.8 -&gt; 2.0.0]
- mime            [repo: CRAN -&gt; RSPM; ver: 0.12 -&gt; 0.13]
- processx        [repo: CRAN -&gt; RSPM; ver: 3.8.3 -&gt; 3.8.6]
- ps              [repo: CRAN -&gt; RSPM; ver: 1.7.6 -&gt; 1.9.1]
- R6              [repo: CRAN -&gt; RSPM; ver: 2.5.1 -&gt; 2.6.1]
- rlang           [repo: CRAN -&gt; RSPM; ver: 1.1.3 -&gt; 1.1.6]
- sass            [repo: CRAN -&gt; RSPM; ver: 0.4.8 -&gt; 0.4.10]
- stringi         [repo: CRAN -&gt; RSPM; ver: 1.8.3 -&gt; 1.8.7]
- sys             [repo: CRAN -&gt; RSPM; ver: 3.4.2 -&gt; 3.4.3]
- tidyselect      [repo: CRAN -&gt; RSPM; ver: 1.2.0 -&gt; 1.2.1]
- withr           [repo: CRAN -&gt; RSPM; ver: 3.0.0 -&gt; 3.0.2]

The version of R recorded in the lockfile will be updated:
- R               [4.3.2 -&gt; 4.5.0]

- Lockfile written to "~/Desktop/Studium/2. Semester/PRR/PRR _MC_21052024/Report/renv.lock".</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wenn das Projekt z.B. von GitHub heruntergeladen wurde, stellte alle </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pakete her (d.h. installiere enstprechende Versionen)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">restore</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- The library is already synchronized with the lockfile.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pakete können zwischendurch geupdatet werden</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">update</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Checking for updated packages ... Done!
The following package(s) will be updated:

# CRAN -----------------------------------------------------------------------
- boot      [1.3-31 -&gt; 1.3-32]
- lattice   [0.22-6 -&gt; 0.22-7]
- Matrix    [1.7-3 -&gt; 1.7-4]
- mgcv      [1.9-1 -&gt; 1.9-3]
- renv      [repo: RSPM -&gt; CRAN; ver: 1.0.7 -&gt; 1.1.5]

# Downloading packages -------------------------------------------------------
- Downloading Matrix from CRAN ...              OK [4.7 Mb in 1.2s]
- Downloading lattice from CRAN ...             OK [1.3 Mb in 0.98s]
- Downloading boot from CRAN ...                OK [629.8 Kb in 0.95s]
- Downloading mgcv from CRAN ...                OK [3.3 Mb in 1.7s]
- Downloading renv from CRAN ...                OK [2.2 Mb in 1.6s]
Successfully downloaded 5 packages in 6.7 seconds.

The following package(s) will be installed:
- boot    [1.3-32]
- lattice [0.22-7]
- Matrix  [1.7-4]
- mgcv    [1.9-3]
- renv    [1.1.5]
These packages will be installed into "~/Desktop/Studium/2. Semester/PRR/PRR _MC_21052024/Report/renv/library/macos/R-4.5/aarch64-apple-darwin20".

# Installing packages --------------------------------------------------------
- Installing lattice ...                        OK [installed binary and cached in 0.27s]
- Installing Matrix ...                         OK [installed binary and cached in 0.34s]
- Installing boot ...                           OK [installed binary and cached in 0.23s]
- Installing mgcv ...                           OK [installed binary and cached in 0.25s]
- Installing renv ...                           OK [installed binary and cached in 0.26s]
Successfully installed 5 packages in 1.4 seconds.

The following loaded package(s) have been updated:
- renv
Restart your R session to use the new versions.</code></pre>
</div>
</div>
</section>
<section id="installieren-der-packages" class="level2">
<h2 class="anchored" data-anchor-id="installieren-der-packages">1.2 Installieren der packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Installieren der Packages, falls noch nicht vorhanden</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"rvest"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"rvest"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"tidyverse"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"stringr"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"stringr"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"purrr"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"purrr"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"tibble"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"tibble"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"DT"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"DT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="laden-der-packages" class="level2">
<h2 class="anchored" data-anchor-id="laden-der-packages">1.3 Laden der packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'rvest'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'tidyverse'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.2
✔ ggplot2   4.0.0     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.1.0     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter()         masks stats::filter()
✖ readr::guess_encoding() masks rvest::guess_encoding()
✖ dplyr::lag()            masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'stringr'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'purrr'</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'tibble'</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'DT'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="webscraping" class="level1">
<h1>2. WEBSCRAPING</h1>
<section id="funktion-extraktion-letzte-seite" class="level2">
<h2 class="anchored" data-anchor-id="funktion-extraktion-letzte-seite">2.1 Funktion Extraktion letzte Seite</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Funktion zur Extraktion der Nummer der letzten Seite aus einer URL</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>get_last_page <span class="ot">&lt;-</span> <span class="cf">function</span>(url) {</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Lädt das HTML-Dokument von der angegebenen URL</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Verwendet CSS-Selektoren, um das vorletzte Element innerhalb der Paginator-Box zu extrahieren</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  last_page_number <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_elements</span>(<span class="st">".HgPaginationSelector_paginatorBox_nNiMu a:nth-last-of-type(2)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extrahiert den Textinhalt des HTML-Elements (dies sollte die Seitenzahl sein)</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Schneidet das letzte Zeichen des Textes ab (Seitenzahl als letztes Zeichen)</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_sub</span>(.,<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Konvertiert den extrahierten Text in eine numerische Form</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Druckt die extrahierte Nummer der letzten Seite zur Überprüfung</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Extracted last page number:"</span>, last_page_number))</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Gibt die Nummer der letzten Seite zurück</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(last_page_number)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="erstellen-des-leeren-dataframes" class="level2">
<h2 class="anchored" data-anchor-id="erstellen-des-leeren-dataframes">2.2 Erstellen des leeren Dataframes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>immoscout24_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="vektorerstellung-der-gesuchten-städte" class="level2">
<h2 class="anchored" data-anchor-id="vektorerstellung-der-gesuchten-städte">2.3 Vektorerstellung der gesuchten Städte</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstellen des Vektors mit den gesuchten Städten</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>cities <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"basel"</span>, <span class="st">"zuerich"</span>, <span class="st">"bern"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scraping" class="level2">
<h2 class="anchored" data-anchor-id="scraping">2.4 Scraping</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scraping mittels for-Schleife über alle Städte und deren Seiten</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (city <span class="cf">in</span> cities) {  <span class="co"># Schleife über alle Städte</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  link <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://www.immoscout24.ch/de/immobilien/mieten/ort-"</span>, city, <span class="st">"?pn=1&amp;nrf=3.5&amp;nrt=3.5"</span>)  <span class="co"># URL Suche der gewünschten Stadt</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  last_page <span class="ot">&lt;-</span> <span class="fu">get_last_page</span>(link)  <span class="co"># Letzte Seitenzahl extrahieren</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (page_result <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>last_page) {  <span class="co"># Schleife über die Seitenzahlen</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    link <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://www.immoscout24.ch/de/immobilien/mieten/ort-"</span>,      city, <span class="st">"?pn="</span>, page_result, <span class="st">"&amp;nrf=3.5&amp;nrt=3.5"</span>)  <span class="co"># URL der Seite</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(link)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    size <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_elements</span>(<span class="st">"span+strong"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">gsub</span>(<span class="st">"m²"</span>, <span class="st">""</span>, .) <span class="sc">%&gt;%</span>  <span class="co"># mit gsub m2 entfernen aus Fläche</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>() <span class="co"># in numerische Zahl umwandeln</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    price <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_elements</span>(<span class="st">".HgListingRoomsLivingSpacePrice_price_u9Vee"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">"[^0-9]"</span>, <span class="at">replace =</span><span class="st">""</span>, .) <span class="sc">%&gt;%</span> <span class="co"># Alle Werte ersetzen die keine Zahl zwischen 0-9 sind; Preis wird bspw. von " CHF 1’180.– " zu 1180</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    plz <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_elements</span>(<span class="st">"div address"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sapply</span>(<span class="cf">function</span>(x) {</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>        parts <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(x, <span class="st">" "</span>)[[<span class="dv">1</span>]]  <span class="co"># Teilt die Adresse an den Leerzeichen</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(parts) <span class="sc">&gt;=</span> <span class="dv">2</span>) {</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>          sub_part <span class="ot">&lt;-</span> <span class="fu">trimws</span>(parts[<span class="fu">length</span>(parts)<span class="sc">-</span><span class="dv">1</span>])  <span class="co"># Wählt vorletzten Teil und entfernt führende/anhängende Leerzeichen</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">return</span>(sub_part)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">return</span>(<span class="cn">NA</span>)  <span class="co"># Rückgabe NA, wenn weniger als zwei Teile vorhanden sind</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ermitteln der maximalsten Länge</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>  max_length <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">length</span>(price), <span class="fu">length</span>(plz), <span class="fu">length</span>(size))</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Listen auf maximale Länge bringen</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(price) <span class="ot">&lt;-</span> max_length</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(plz) <span class="ot">&lt;-</span> max_length</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(size) <span class="ot">&lt;-</span> max_length</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Zusammenfügen der Daten zu einem DataFrame</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>  new_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"Price [CHF]"</span> <span class="ot">=</span> price, <span class="st">"Size [m2]"</span> <span class="ot">=</span> size, <span class="at">PLZ =</span> plz, <span class="at">City =</span> city)</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>  immoscout24_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(immoscout24_df, new_data)</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Drucke die Seitennummer und den Link</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"City:"</span>, city,<span class="st">"/ Page:"</span>, page_result, <span class="st">"/ Link:"</span>, link))</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Schutzmechanismus der Webseite umgehen (wegen zu vielen Anfragen); sonst Bann </span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">5</span>) <span class="co"># 5 Sekunden</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(city, <span class="st">"Finished"</span>))</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Extracted last page number: 9"
[1] "City: basel / Page: 1 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-basel?pn=1&amp;nrf=3.5&amp;nrt=3.5"
[1] "City: basel / Page: 2 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-basel?pn=2&amp;nrf=3.5&amp;nrt=3.5"
[1] "City: basel / Page: 3 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-basel?pn=3&amp;nrf=3.5&amp;nrt=3.5"
[1] "City: basel / Page: 4 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-basel?pn=4&amp;nrf=3.5&amp;nrt=3.5"
[1] "City: basel / Page: 5 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-basel?pn=5&amp;nrf=3.5&amp;nrt=3.5"
[1] "City: basel / Page: 6 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-basel?pn=6&amp;nrf=3.5&amp;nrt=3.5"
[1] "City: basel / Page: 7 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-basel?pn=7&amp;nrf=3.5&amp;nrt=3.5"
[1] "City: basel / Page: 8 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-basel?pn=8&amp;nrf=3.5&amp;nrt=3.5"
[1] "City: basel / Page: 9 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-basel?pn=9&amp;nrf=3.5&amp;nrt=3.5"
[1] "basel Finished"
[1] "Extracted last page number: 2"
[1] "City: zuerich / Page: 1 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-zuerich?pn=1&amp;nrf=3.5&amp;nrt=3.5"
[1] "City: zuerich / Page: 2 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-zuerich?pn=2&amp;nrf=3.5&amp;nrt=3.5"
[1] "zuerich Finished"
[1] "Extracted last page number: 5"
[1] "City: bern / Page: 1 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-bern?pn=1&amp;nrf=3.5&amp;nrt=3.5"
[1] "City: bern / Page: 2 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-bern?pn=2&amp;nrf=3.5&amp;nrt=3.5"
[1] "City: bern / Page: 3 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-bern?pn=3&amp;nrf=3.5&amp;nrt=3.5"
[1] "City: bern / Page: 4 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-bern?pn=4&amp;nrf=3.5&amp;nrt=3.5"
[1] "City: bern / Page: 5 / Link: https://www.immoscout24.ch/de/immobilien/mieten/ort-bern?pn=5&amp;nrf=3.5&amp;nrt=3.5"
[1] "bern Finished"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Scraping finished"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Scraping finished"</code></pre>
</div>
</div>
</section>
</section>
<section id="datenaufbereitung" class="level1">
<h1>3. DATENAUFBEREITUNG</h1>
<section id="übersicht" class="level2">
<h2 class="anchored" data-anchor-id="übersicht">3.1 Übersicht</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(immoscout24_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [302 × 4] (S3: tbl_df/tbl/data.frame)
 $ Price [CHF]: num [1:302] NA 3650 3390 2560 2760 2690 4020 2270 5520 3900 ...
 $ Size [m2]  : num [1:302] 86 130 79 78 83 102 78 170 160 170 ...
 $ PLZ        : Named chr [1:302] "4055" "4057" "4054" "4057" ...
  ..- attr(*, "names")= chr [1:302] "Allschwilerstrasse 38, 4055 Basel" "Brombacherstrasse 7, 4057 Basel" "Weiherhofstrasse, 4054 Basel" "Kleinhüningeranlage 17, 4057 Basel" ...
 $ City       : chr [1:302] "basel" "basel" "basel" "basel" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(immoscout24_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Price [CHF]     Size [m2]       PLZ                City          
 Min.   :1780   Min.   : 62   Length:302         Length:302        
 1st Qu.:2620   1st Qu.: 84   Class :character   Class :character  
 Median :3000   Median : 92   Mode  :character   Mode  :character  
 Mean   :3392   Mean   :100                                        
 3rd Qu.:3945   3rd Qu.:106                                        
 Max.   :7370   Max.   :250                                        
 NA's   :3      NA's   :40                                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(immoscout24_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 302 × 4
   `Price [CHF]` `Size [m2]` PLZ   City 
           &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
 1            NA          86 4055  basel
 2          3650         130 4057  basel
 3          3390          79 4054  basel
 4          2560          78 4057  basel
 5          2760          83 4053  basel
 6          2690         102 4056  basel
 7          4020          78 4051  basel
 8          2270         170 4058  basel
 9          5520         160 4001  basel
10          3900         170 4052  basel
# ℹ 292 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interaktive Tabelle mittels DT</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(immoscout24_df, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>, <span class="at">autoWidth =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-ae2b265eeb0b907ca728" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ae2b265eeb0b907ca728">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302"],[null,3650,3390,2560,2760,2690,4020,2270,5520,3900,4400,3980,3040,2960,2210,2850,4390,6680,4200,3770,2900,2820,2920,2480,2840,3270,5060,2690,4390,2900,4100,3000,3410,2410,2980,2320,2250,3980,3860,2940,3670,2870,3570,4430,2910,2400,4510,3490,3520,4510,3350,2640,3690,3660,3390,3500,2670,2500,2870,2660,2430,2520,3150,2490,2870,2630,4510,2590,2450,3250,2360,2410,2150,2830,3080,2500,3270,5360,5050,3830,3930,2940,3520,3480,4020,2910,2450,2870,2830,3170,4940,3160,4200,2740,3040,2870,2960,2660,2520,2420,2950,4250,2640,4610,3270,4500,3950,2080,3000,4230,3100,2840,2700,3680,3250,3670,3210,3400,2000,4190,3820,2480,3000,2600,2260,2800,2930,3110,3900,4080,2430,3200,2360,2930,2560,2120,1990,2330,4070,6550,2530,3480,2900,3230,2860,2600,3270,1780,2670,2510,2820,3060,2380,2420,2410,2250,2660,2320,2660,2560,2570,3000,3820,2520,2020,5640,5390,4650,5420,5080,4980,4700,4520,5600,5940,4710,5950,4640,5930,4780,5410,4610,3920,3990,7370,5430,4660,5110,6960,5980,5050,5390,4450,6500,5980,5980,5980,4450,4450,4450,5690,5520,4740,4750,5430,3390,3130,2740,2670,2040,2590,4500,3070,2860,4470,2900,4770,6120,2780,2730,4270,5430,3660,2680,2800,2250,2960,2690,3200,3220,3230,null,2820,2780,3620,2640,2990,3310,2460,null,2640,2570,3120,3010,3850,2750,2490,2950,2620,3000,2560,2350,3940,2360,2900,2250,3160,2750,2380,3430,3310,3000,3250,3250,2620,2780,3000,3280,2610,2800,2990,2940,3370,2540,2410,3390,2960,2420,2930,4290,2320,2130,2170,2560,2960,2570,2490,3750,1840,2380,3350,2110,2540,2590,2590,2660,2700,3270,2280,2680,3480,2300],[86,130,79,78,83,102,78,170,160,170,170,90,84,74,92,97,250,108,87,null,79,90,90,91,86,86,170,102,180,92,130,91,87,81,107,78,86,94,82,86,190,96,94,130,95,91,160,92,100,130,82,93,140,140,109,170,78,91,106,81,76,76,69,91,84,93,210,72,91,83,81,86,81,72,102,79,91,104,97,null,130,100,107,150,150,79,81,79,98,150,130,78,87,78,74,98,85,82,null,null,76,100,91,160,103,84,82,130,83,140,106,63,150,null,null,null,null,null,null,null,160,82,84,81,94,98,84,91,130,140,81,97,79,85,87,90,101,180,null,null,101,106,83,70,89,83,84,94,102,91,80,62,78,83,72,80,null,null,null,null,93,100,95,78,null,70,108,93,98,107,91,100,85,94,130,93,130,87,130,92,93,85,84,109,null,90,96,100,84,93,85,76,140,84,84,84,76,76,76,150,104,100,85,109,null,108,85,93,83,89,100,100,93,92,140,170,106,108,130,140,130,86,null,null,null,72,105,84,130,107,93,140,107,107,101,84,101,90,130,92,102,140,null,null,null,98,78,108,91,64,109,78,107,78,107,86,91,87,94,85,85,null,null,null,null,107,96,83,83,130,95,107,84,100,103,69,89,84,null,null,null,null,null,null,null,76,89,73,94,78,106,105,105,91,92,89,81,97,86,null,null,null],["4055","4057","4054","4057","4053","4056","4051","4058","4001","4052","4057","4057","4058","4056","4057","4053","4052","4052","4058","4058","4058","4053","4053","4053","4052","4053","4058","4057","4052","4053","4051","4058","4055","4055","4056","4052","4055","4058","4058","4052","4001","4056","4052","4052","4055","4053","4056","4052","4052","4058","4001","4053","4058","4058","4001","4051","4057","4055","4058","4053","4053","4053","4053","4053","4053","4058","4052","4053","4055","4059","4058","4052","4057","4057","4053","4052","4056","4001","4058","4053","4051","4052","4056","4058","4051","4057","4057","4057","4055","4056","4051","4055","4056","4058","4052","4058","4056","4057","4055","4055","4052","4055","4057","4058","4058","4059","4051","4057","4056","4058","4058","4056","4056","4056","4053","4058","4052","4056","4057","4053","4051","4056","4051","4052","4057","4057","4055","4057","4052","4052","4052","4056","4056","4057","4058","4053","4053","4057","4053","4051","4056","4057","4056","4056","4056","4059","4051","4057","4056","4053","4052","4056","4057","4058","4057","4057","4052","4059","4053","4052","4058","4051","4053","4052","4057","8006","8003","8050","8050","8050","8051","8053","8048","8048","8047","8047","8047","8047","8047","8047","8003","8004","8049","8057","8006","8053","8051","8049","8008","8050","8037","8002","8050","8001","8006","8008","8001","8006","8008","8001","8045","8044","8006","8005","8057","3007","3006","3011","3006","3012","3007","3012","3005","3008","3011","3008","3011","3013","3027","3027","3005","3013","3013","3014","3006","3018","3027","3018","3015","3018","3006","3011","3027","3027","3008","3027","3027","3008","3027","3011","3007","3013","3014","3006","3027","3014","3007","3013","3012","3027","3014","3014","3011","3008","3014","3027","3027","3006","3012","3018","3018","3012","3008","3008","3013","3027","3027","3012","3007","3012","3027","3027","3012","3008","3008","3027","3027","3027","3007","3018","3027","3008","3018","3013","3027","3014","3012","3011","3018","3012","3012","3007","3008","3012","3012","3007","3007","3012","3004","3005","3007","3012"],["basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","basel","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","zuerich","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern","bern"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Price [CHF]<\/th>\n      <th>Size [m2]<\/th>\n      <th>PLZ<\/th>\n      <th>City<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"autoWidth":true,"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Price [CHF]","targets":1},{"name":"Size [m2]","targets":2},{"name":"PLZ","targets":3},{"name":"City","targets":4}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="beobachtungen-mit-nas-entfernen" class="level2">
<h2 class="anchored" data-anchor-id="beobachtungen-mit-nas-entfernen">3.2 Beobachtungen mit NA’s entfernen</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>immoscout24_df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(immoscout24_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="datenexploration" class="level1">
<h1>4. DATENEXPLORATION</h1>
<section id="vergleich-statistischer-kennzahlen" class="level2">
<h2 class="anchored" data-anchor-id="vergleich-statistischer-kennzahlen">4.1 Vergleich statistischer Kennzahlen</h2>
<section id="erstellen-der-summaries" class="level3">
<h3 class="anchored" data-anchor-id="erstellen-der-summaries">4.1.1 Erstellen der Summaries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary der Daten erstellen</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>summary_all_cities_prices <span class="ot">&lt;-</span> <span class="fu">summary</span>(immoscout24_df<span class="sc">$</span><span class="st">`</span><span class="at">Price [CHF]</span><span class="st">`</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>summary_all_cities_sizes <span class="ot">&lt;-</span> <span class="fu">summary</span>(immoscout24_df<span class="sc">$</span><span class="st">`</span><span class="at">Size [m2]</span><span class="st">`</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>summary_basel_prices <span class="ot">&lt;-</span> <span class="fu">summary</span>(immoscout24_df<span class="sc">$</span><span class="st">`</span><span class="at">Price [CHF]</span><span class="st">`</span>[immoscout24_df<span class="sc">$</span>City <span class="sc">==</span> <span class="st">"basel"</span>])</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>summary_basel_sizes <span class="ot">&lt;-</span> <span class="fu">summary</span>(immoscout24_df<span class="sc">$</span><span class="st">`</span><span class="at">Size [m2]</span><span class="st">`</span>[immoscout24_df<span class="sc">$</span>City <span class="sc">==</span> <span class="st">"basel"</span>])</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>summary_zuerich_prices <span class="ot">&lt;-</span> <span class="fu">summary</span>(immoscout24_df<span class="sc">$</span><span class="st">`</span><span class="at">Price [CHF]</span><span class="st">`</span>[immoscout24_df<span class="sc">$</span>City <span class="sc">==</span> <span class="st">"zuerich"</span>])</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>summary_zuerich_sizes <span class="ot">&lt;-</span> <span class="fu">summary</span>(immoscout24_df<span class="sc">$</span><span class="st">`</span><span class="at">Size [m2]</span><span class="st">`</span>[immoscout24_df<span class="sc">$</span>City <span class="sc">==</span> <span class="st">"zuerich"</span>])</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>summary_bern_prices <span class="ot">&lt;-</span> <span class="fu">summary</span>(immoscout24_df<span class="sc">$</span><span class="st">`</span><span class="at">Price [CHF]</span><span class="st">`</span>[immoscout24_df<span class="sc">$</span>City <span class="sc">==</span> <span class="st">"bern"</span>])</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>summary_bern_sizes <span class="ot">&lt;-</span> <span class="fu">summary</span>(immoscout24_df<span class="sc">$</span><span class="st">`</span><span class="at">Size [m2]</span><span class="st">`</span>[immoscout24_df<span class="sc">$</span>City <span class="sc">==</span> <span class="st">"bern"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="erstellen-des-dataframes" class="level3">
<h3 class="anchored" data-anchor-id="erstellen-des-dataframes">4.1.2 Erstellen des Dataframes</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstellung Dataframe</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>summary_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Stadt =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Alle Städte"</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="st">"Basel"</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="st">"Zürich"</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="st">"Bern"</span>, <span class="dv">6</span>)),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Kennwert =</span> <span class="fu">rep</span>(<span class="fu">names</span>(summary_all_cities_prices), <span class="dv">4</span>),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Preis =</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(summary_all_cities_prices), </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(summary_basel_prices), </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(summary_zuerich_prices), </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(summary_bern_prices)),</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  Grösse <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(summary_all_cities_sizes), </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(summary_basel_sizes), </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(summary_zuerich_sizes), </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(summary_bern_sizes))</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean-Werte runden</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>summary_df <span class="ot">&lt;-</span> summary_df <span class="sc">%&gt;%</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Preis =</span> <span class="fu">ifelse</span>(Kennwert <span class="sc">==</span> <span class="st">"Mean"</span>, <span class="fu">round</span>(Preis, <span class="dv">0</span>), Preis),</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    Grösse <span class="ot">=</span> <span class="fu">ifelse</span>(Kennwert <span class="sc">==</span> <span class="st">"Mean"</span>, <span class="fu">round</span>(Grösse, <span class="dv">0</span>), Grösse)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Stadt Kennwert  Preis Grösse
1  Alle Städte     Min. 1780.0  62.00
2  Alle Städte  1st Qu. 2635.0  84.00
3  Alle Städte   Median 3000.0  92.00
4  Alle Städte     Mean 3411.0 100.00
5  Alle Städte  3rd Qu. 4005.0 106.00
6  Alle Städte     Max. 6960.0 250.00
7        Basel     Min. 1780.0  62.00
8        Basel  1st Qu. 2592.5  82.00
9        Basel   Median 2935.0  91.00
10       Basel     Mean 3168.0 102.00
11       Basel  3rd Qu. 3557.5 105.50
12       Basel     Max. 6680.0 250.00
13      Zürich     Min. 3920.0  70.00
14      Zürich  1st Qu. 4652.5  84.25
15      Zürich   Median 5095.0  93.00
16      Zürich     Mean 5194.0  97.00
17      Zürich  3rd Qu. 5677.5 103.00
18      Zürich     Max. 6960.0 150.00
19        Bern     Min. 1840.0  64.00
20        Bern  1st Qu. 2570.0  85.00
21        Bern   Median 2780.0  94.00
22        Bern     Mean 2982.0  98.00
23        Bern  3rd Qu. 3225.0 107.00
24        Bern     Max. 6120.0 170.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interaktive Tabelle mit DT anzeigen</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(summary_df, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>, <span class="at">autoWidth =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-c1a6578b2d77a991e166" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c1a6578b2d77a991e166">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],["Alle Städte","Alle Städte","Alle Städte","Alle Städte","Alle Städte","Alle Städte","Basel","Basel","Basel","Basel","Basel","Basel","Zürich","Zürich","Zürich","Zürich","Zürich","Zürich","Bern","Bern","Bern","Bern","Bern","Bern"],["Min.","1st Qu.","Median","Mean","3rd Qu.","Max.","Min.","1st Qu.","Median","Mean","3rd Qu.","Max.","Min.","1st Qu.","Median","Mean","3rd Qu.","Max.","Min.","1st Qu.","Median","Mean","3rd Qu.","Max."],[1780,2635,3000,3411,4005,6960,1780,2592.5,2935,3168,3557.5,6680,3920,4652.5,5095,5194,5677.5,6960,1840,2570,2780,2982,3225,6120],[62,84,92,100,106,250,62,82,91,102,105.5,250,70,84.25,93,97,103,150,64,85,94,98,107,170]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Stadt<\/th>\n      <th>Kennwert<\/th>\n      <th>Preis<\/th>\n      <th>Grösse<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"autoWidth":true,"columnDefs":[{"className":"dt-right","targets":[3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Stadt","targets":1},{"name":"Kennwert","targets":2},{"name":"Preis","targets":3},{"name":"Grösse","targets":4}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="lollipop-plot-summary-preise-und-wohnungsgrössen" class="level3">
<h3 class="anchored" data-anchor-id="lollipop-plot-summary-preise-und-wohnungsgrössen">4.1.3 Lollipop-Plot Summary Preise und Wohnungsgrössen</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reihenfolge der Kennwerte festlegen</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>summary_df<span class="sc">$</span>Kennwert <span class="ot">&lt;-</span> <span class="fu">factor</span>(summary_df<span class="sc">$</span>Kennwert, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Min."</span>, <span class="st">"1st Qu."</span>, <span class="st">"Median"</span>, <span class="st">"Mean"</span>, <span class="st">"3rd Qu."</span>, <span class="st">"Max."</span>))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Farbenzuteilung</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>farben <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Basel"</span> <span class="ot">=</span> <span class="st">"#E41A1C"</span>, <span class="st">"Zürich"</span> <span class="ot">=</span> <span class="st">"#377EB8"</span>, <span class="st">"Bern"</span> <span class="ot">=</span> <span class="st">"#4DAF4A"</span>, <span class="st">"Alle Städte"</span> <span class="ot">=</span> <span class="st">"#984EA3"</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Lollipop-Plot für Summary der Preise</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_df, <span class="fu">aes</span>(<span class="at">x =</span> Stadt, <span class="at">y =</span> Preis, <span class="at">color =</span> Stadt)) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> Stadt, <span class="at">xend =</span> Stadt, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> Preis), <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Kennwert, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> farben) <span class="sc">+</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Zusammenfassung der Preise nach Stadt"</span>, <span class="at">y =</span> <span class="st">"Preis in CHF"</span>) <span class="sc">+</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>), </span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PRR_MC_QuartoDocument_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lollipop-Plot für Summary der Wohnungsgrössen</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_df, <span class="fu">aes</span>(<span class="at">x =</span> Stadt, <span class="at">y =</span> Grösse, <span class="at">color =</span> Stadt)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> Stadt, <span class="at">xend =</span> Stadt, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> Grösse), <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Kennwert, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> farben) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Zusammenfassung der Wohnungsgrössen nach Stadt"</span>, <span class="at">y =</span> <span class="st">"Grösse in m²"</span>) <span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>), </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PRR_MC_QuartoDocument_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="barplot-anzahl-angebote" class="level2">
<h2 class="anchored" data-anchor-id="barplot-anzahl-angebote">4.2 Barplot Anzahl Angebote</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(immoscout24_df, <span class="fu">aes</span>(<span class="at">x =</span> City, <span class="at">fill =</span> City)) <span class="sc">+</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span>  <span class="co"># Erstellt das Balkendiagramm</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">'count'</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(count)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Anzahl Angebote pro Stadt"</span>) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PRR_MC_QuartoDocument_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scatterplot-wohnungsgrösse-vs.-preis" class="level2">
<h2 class="anchored" data-anchor-id="scatterplot-wohnungsgrösse-vs.-preis">4.3 Scatterplot Wohnungsgrösse vs.&nbsp;Preis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(immoscout24_df, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">Size [m2]</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Price [CHF]</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>City) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Vergleich Städte: Size/Price"</span>) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PRR_MC_QuartoDocument_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="densityplot-preisvergleich" class="level2">
<h2 class="anchored" data-anchor-id="densityplot-preisvergleich">4.4 Densityplot Preisvergleich</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(immoscout24_df, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">Price [CHF]</span><span class="st">`</span>, <span class="at">fill =</span> City)) <span class="sc">+</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Preisvergleich nach Stadt"</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">ovveride.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in guide_legend(ovveride.aes = list(alpha = 1)): Arguments in `...` must be used.
✖ Problematic argument:
• ovveride.aes = list(alpha = 1)
ℹ Did you misspell an argument name?</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PRR_MC_QuartoDocument_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="densityplot-wohnungsgrössenvergleich" class="level2">
<h2 class="anchored" data-anchor-id="densityplot-wohnungsgrössenvergleich">4.5 Densityplot Wohnungsgrössenvergleich</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(immoscout24_df, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">Size [m2]</span><span class="st">`</span>, <span class="at">fill =</span> City)) <span class="sc">+</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Füllt die Density-Kurven und setzt Transparenz</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wohnungsgrössenvergleich nach Stadt"</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>)))  <span class="co"># Setzt Alpha für die Legende auf 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PRR_MC_QuartoDocument_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boxplot-preisvergleich" class="level2">
<h2 class="anchored" data-anchor-id="boxplot-preisvergleich">4.6 Boxplot Preisvergleich</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(immoscout24_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Price [CHF]</span><span class="st">`</span>, <span class="at">fill =</span> City)) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> City, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">space =</span> <span class="st">"free_x"</span>) <span class="sc">+</span>  <span class="co"># Jede Stadt bekommt eine eigene Spalte, aber alle teilen die gleiche y-Achse</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Preisvergleich nach Stadt"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Preis in CHF"</span>) <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Entfernt die x-Achsen-Beschriftungen</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Entfernt die x-Achsen-Ticks</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),  <span class="co"># Entfernt den Hintergrund der Facetten-Titel</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)  <span class="co"># Zentriert die Facetten-Titel</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PRR_MC_QuartoDocument_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boxplot-wohnungsgrössenvergleich" class="level2">
<h2 class="anchored" data-anchor-id="boxplot-wohnungsgrössenvergleich">4.7 Boxplot Wohnungsgrössenvergleich</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(immoscout24_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Size [m2]</span><span class="st">`</span>, <span class="at">fill =</span> City)) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> City, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">space =</span> <span class="st">"free_x"</span>) <span class="sc">+</span>  <span class="co"># Jede Stadt bekommt eine eigene Spalte, aber alle teilen die gleiche y-Achse</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wohnungsgrössenvergleich nach Stadt"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Grösse in m2"</span>) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Entfernt die x-Achsen-Beschriftungen</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Entfernt die x-Achsen-Ticks</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),  <span class="co"># Entfernt den Hintergrund der Facetten-Titel</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)  <span class="co"># Zentriert die Facetten-Titel</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PRR_MC_QuartoDocument_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="barplot-anzahl-plz" class="level2">
<h2 class="anchored" data-anchor-id="barplot-anzahl-plz">4.8 Barplot Anzahl PLZ</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Daten nach City und PLZ gruppieren und die Anzahl für jede PLZ zählen</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>grouped_city <span class="ot">&lt;-</span> immoscout24_df <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(City, PLZ) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Anzahl =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(City) <span class="sc">%&gt;%</span>  <span class="co"># Gruppieren nach Stadt für die Summation</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total =</span> <span class="fu">sum</span>(Anzahl),  <span class="co"># Summe der Anzahlen pro Stadt</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Relative_Haeufigkeit =</span> Anzahl <span class="sc">/</span> Total) <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()  <span class="co"># Entfernen der Gruppierung</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Balkendiagramm erstellen mit einer Facette für jede Stadt und relative Häufigkeit anzeigen</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(grouped_city, <span class="fu">aes</span>(<span class="at">x =</span> PLZ, <span class="at">y =</span> Relative_Haeufigkeit, <span class="at">fill =</span> City)) <span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">toupper</span>(City), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span>  <span class="co"># Städtenamen in Facetten, vertikal angeordnet</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relative PLZ-Häufigkeit pro Stadt"</span>, <span class="at">x =</span> <span class="st">"PLZ"</span>, <span class="at">y =</span> <span class="st">"Relative Häufigkeit"</span>) <span class="sc">+</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>),  <span class="co"># Dreht die PLZ auf der X-Achse für bessere Lesbarkeit und zentriert sie</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),  <span class="co"># Vergrössert die Facetten-Titel</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>  <span class="co"># Entfernt die Legende</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PRR_MC_QuartoDocument_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="resultate" class="level1">
<h1>5. RESULTATE</h1>
<ul>
<li><p><strong>Mietpreise</strong>: Zürich hat die höchsten Median - Mietpreise für 3.5-Zimmerwohnungen, gefolgt von Basel und Bern.</p></li>
<li><p><strong>Preisspanne</strong>: Zürich zeigt eine breitere Verteilung der Mietpreise, während Basel und Bern eine konzentriertere Verteilung aufweisen.</p></li>
<li><p><strong>Durchschnittliche Wohnungsgrössen</strong>: Die Verteilung der Wohnungsgrössen ist in allen drei Städten ähnlich, mit einem Schwerpunkt auf Wohnungen zwischen 70 und 100 Quadratmetern. In Bern dominieren kleinere Wohnungen.</p></li>
<li><p><strong>Anzahl der Angebote</strong>: Zürich und Basel haben fast identisch viele Angebote für 3.5-Zimmerwohnungen und bieten jeweils etwa 40% mehr Wohnungen als Bern.</p></li>
<li><p><strong>Korrelation Preis / Wohnungsgrösse</strong> : Es gibt eine positive Korrelation zwischen Wohnungsgrösse und Mietpreis in allen drei Städten. Zürich zeigt häufigere und extremere Ausreisser, bei denen grosse Wohnungen extrem hohe Preise haben.</p></li>
<li><p><strong>Relative Häufigkeit PLZ</strong>: Die freien Wohnungen konzentrieren sich in Basel auf die PLZ 4057 (ca. 20 %), in Zürich auf die PLZ 8050 (ca. 15 %) sowie Bern auf die PLZ 3018 (ca. 20 %)</p></li>
</ul>
</section>
<section id="ausblick" class="level1">
<h1>6. AUSBLICK</h1>
<ul>
<li><strong>Problematik:</strong> Stichprobengrösse mit Tag n = 1 , dadurch keine verlässliche Interpretation möglich</li>
</ul>
<p><strong>Weiterführende Analysen</strong>:</p>
<ul>
<li><p><strong>Preisentwicklung</strong>: Überwachung und Analyse der Mietpreisentwicklung über einen längeren Zeitraum, um Trends und Muster zu erkennen.</p></li>
<li><p><strong>Prognosen</strong>: Erstellung von Modellen zur Vorhersage zukünftiger Mietpreise basierend auf langfristiger Preisentwicklung</p></li>
<li><p><strong>Stadtteilanalyse</strong>: Detaillierte Analyse der Mietpreise auf Stadtteilebene, um Unterschiede innerhalb einer Stadt zu identifizieren.</p></li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>